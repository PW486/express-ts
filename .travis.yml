language: node_js

services:
  - docker

before_install:
  - docker -v
  - npm install
  - npm run build
  - cp .env.example .env
  - sudo /etc/init.d/postgresql stop

install:
  - docker-compose -f docker-compose-test.yml build
  - docker-compose -f docker-compose-test.yml up -d

script:
  - docker-compose -f docker-compose-test.yml exec app sh -c "npm test"
